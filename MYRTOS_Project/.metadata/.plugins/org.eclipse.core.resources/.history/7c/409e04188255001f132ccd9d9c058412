/*
 * CortexMX_OS_porting.h
 *
 *  Created on: Aug 8, 2024
 *      Author: Hisham
 */

#ifndef CORTEXMX_OS_PORTING_H_
#define CORTEXMX_OS_PORTING_H_

#include "ARMCM3.h"

#define OS_SET_PSP(add) 			__asm volatile("mov r0,%0 \n\t  msr PSP,r0 " : : "r" (add) )
#define OS_GET_PSP(add) 			__asm volatile("mov r0,%0 \n\t  mrr r0,PSP " : : "r" (add) )



#define OS_SWITCH_SP_to_PSP	 		__asm volatile("mrs r0,CONTROL \n\t  mov r1,#0x02  \n\t	orr r0,r0,r1 \n\t msr CONTROL,r0  ")
#define OS_SWITCH_SP_to_MSP	 		__asm volatile("mrs r0,CONTROL \n\t  mov r1,#0x05  \n\t	and r0,r0,r1 \n\t msr CONTROL,r0  ")

#endif /* CORTEXMX_OS_PORTING_H_ */
